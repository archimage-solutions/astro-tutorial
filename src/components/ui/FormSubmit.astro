---
const formAction = "https://formsubmit.co/95a44f8e3c0001e662ccc2747c480774"; // Replace with your Formspree action URL

const thankYouRef = Astro.site?.href + 'thankyou'
---
<section class="space-y-6">
  <h2 class="text-2xl font-bold text-center">Get in Touch</h2>
  <form id="contactForm" action={formAction} method="POST" accept-charset="UTF-8" enctype="multipart/form-data" class="space-y-4">
    <div class="form-group">
      <label for="email" class="block text-sm font-medium text-gray-700">
        Your Email:
      </label>
      <input
        type="email"
        id="email"
        name="email"
        required
        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
      />
    </div>

    <div class="form-group">
      <label for="message" class="block text-sm font-medium text-gray-700">
        Your Message:
      </label>
      <textarea
        id="message"
        name="message"
        rows="4"
        required
        class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
      ></textarea>
    </div>

    <input type="hidden" name="_next" value={thankYouRef}>
    <input type="hidden" name="_subject" value="Your contact with Archimage Solutions">
    <input type="hidden" name="_blacklist" value="cash free debt porn">
    <input type="hidden" name="_autoresponse" value="Thanks for contacting Archimage Solutions">
    <input type="hidden" name="_template" value="table">
    <!-- <button
      type="submit"
      class="w-full py-2 px-4 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
    >
      Send
    </button> -->
    <button
      type="submit"
      id="submitButton"
      class="w-full py-2 px-4 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
    >
      <span id="buttonText">Send</span>
      <span id="loadingSpinner" class="hidden">
        <svg class="animate-spin h-5 w-5 inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Sending...
      </span>
    </button>
  </form>
</section>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('contactForm');
    const buttonText = document.getElementById('buttonText');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const submitButton = document.getElementById('submitButton');

    form?.addEventListener('submit', () => {
      buttonText!.classList.add('hidden');
      loadingSpinner!.classList.remove('hidden');
      (submitButton as HTMLButtonElement)!.disabled = true;
    });
  });
</script>
